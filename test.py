
from fcapy import *


client = Client()

api = client.login("WwogICAgewogICAgICAgICJrZXkiOiAiZGJsbiIsCiAgICAgICAgInZhbHVlIjogIiU3QiUyMjEwMDAxNzYyNjE0NjQ4NSUyMiUzQSUyMmlRd1RDM1I2JTIyJTdEIiwKICAgICAgICAiZG9tYWluIjogImZhY2Vib29rLmNvbSIsCiAgICAgICAgInBhdGgiOiAiL2xvZ2luL2RldmljZS1iYXNlZC8iLAogICAgICAgICJob3N0T25seSI6IGZhbHNlLAogICAgICAgICJjcmVhdGlvbiI6ICIyMDIzLTEyLTA0VDE3OjE5OjI2LjIyN1oiLAogICAgICAgICJsYXN0QWNjZXNzZWQiOiAiMjAyMy0xMi0wNFQxNzoxOToyNi4yMjdaIgogICAgfSwKICAgIHsKICAgICAgICAia2V5IjogInNiIiwKICAgICAgICAidmFsdWUiOiAibmxCUVpXYXJJMmhWc3A2Uk1aRUtjTzRsIiwKICAgICAgICAiZG9tYWluIjogImZhY2Vib29rLmNvbSIsCiAgICAgICAgInBhdGgiOiAiLyIsCiAgICAgICAgImhvc3RPbmx5IjogZmFsc2UsCiAgICAgICAgImNyZWF0aW9uIjogIjIwMjMtMTItMDRUMTc6MTk6MjYuMjI3WiIsCiAgICAgICAgImxhc3RBY2Nlc3NlZCI6ICIyMDIzLTEyLTA0VDE3OjE5OjI2LjIyN1oiCiAgICB9LAogICAgewogICAgICAgICJrZXkiOiAibV9scyIsCiAgICAgICAgInZhbHVlIjogIiU3QiUyMmMlMjIlM0ElN0IlMjIxJTIyJTNBJTIySEN3QUFCYjRwQVVXdXBpcy1BZ1RCUmJxbXAteDViMHRBQSUyMiUyQyUyMjIlMjIlM0ElMjJHU3dWUUJ4TUFBQVdBUmJDNHN6VkRCWUFBQlYtSEV3QUFCWUFGc0xpek5VTUZnQUFGaWdBJTIyJTJDJTIyOTUlMjIlM0ElMjJIQ3dBQUJiYUJSYUtzcjN5Q0JNRkZ1cWFuN0hsdlMwQSUyMiU3RCUyQyUyMmQlMjIlM0ElMjIwZmNmNzUyNy00MjAxLTQwOGYtODBmMi0yZmRiMGUxMWRhZDUlMjIlMkMlMjJzJTIyJTNBJTIyMCUyMiUyQyUyMnUlMjIlM0ElMjJ2cXExMzYlMjIlN0QiLAogICAgICAgICJkb21haW4iOiAiZmFjZWJvb2suY29tIiwKICAgICAgICAicGF0aCI6ICIvIiwKICAgICAgICAiaG9zdE9ubHkiOiBmYWxzZSwKICAgICAgICAiY3JlYXRpb24iOiAiMjAyMy0xMi0wNFQxNzoxOToyNi4yMjdaIiwKICAgICAgICAibGFzdEFjY2Vzc2VkIjogIjIwMjMtMTItMDRUMTc6MTk6MjYuMjI3WiIKICAgIH0sCiAgICB7CiAgICAgICAgImtleSI6ICJkYXRyIiwKICAgICAgICAidmFsdWUiOiAiSHJaY1phcDdYZjBPR0EwXzhJZmdiaUY2IiwKICAgICAgICAiZG9tYWluIjogImZhY2Vib29rLmNvbSIsCiAgICAgICAgInBhdGgiOiAiLyIsCiAgICAgICAgImhvc3RPbmx5IjogZmFsc2UsCiAgICAgICAgImNyZWF0aW9uIjogIjIwMjMtMTItMDRUMTc6MTk6MjYuMjI3WiIsCiAgICAgICAgImxhc3RBY2Nlc3NlZCI6ICIyMDIzLTEyLTA0VDE3OjE5OjI2LjIyN1oiCiAgICB9LAogICAgewogICAgICAgICJrZXkiOiAibG9jYWxlIiwKICAgICAgICAidmFsdWUiOiAidmlfVk4iLAogICAgICAgICJkb21haW4iOiAiZmFjZWJvb2suY29tIiwKICAgICAgICAicGF0aCI6ICIvIiwKICAgICAgICAiaG9zdE9ubHkiOiBmYWxzZSwKICAgICAgICAiY3JlYXRpb24iOiAiMjAyMy0xMi0wNFQxNzoxOToyNi4yMjdaIiwKICAgICAgICAibGFzdEFjY2Vzc2VkIjogIjIwMjMtMTItMDRUMTc6MTk6MjYuMjI3WiIKICAgIH0sCiAgICB7CiAgICAgICAgImtleSI6ICJkcHIiLAogICAgICAgICJ2YWx1ZSI6ICIxLjEyNSIsCiAgICAgICAgImRvbWFpbiI6ICJmYWNlYm9vay5jb20iLAogICAgICAgICJwYXRoIjogIi8iLAogICAgICAgICJob3N0T25seSI6IGZhbHNlLAogICAgICAgICJjcmVhdGlvbiI6ICIyMDIzLTEyLTA0VDE3OjE5OjI2LjIyN1oiLAogICAgICAgICJsYXN0QWNjZXNzZWQiOiAiMjAyMy0xMi0wNFQxNzoxOToyNi4yMjdaIgogICAgfSwKICAgIHsKICAgICAgICAia2V5IjogImNfdXNlciIsCiAgICAgICAgInZhbHVlIjogIjEwMDAyMTY2ODIwMTE4NyIsCiAgICAgICAgImRvbWFpbiI6ICJmYWNlYm9vay5jb20iLAogICAgICAgICJwYXRoIjogIi8iLAogICAgICAgICJob3N0T25seSI6IGZhbHNlLAogICAgICAgICJjcmVhdGlvbiI6ICIyMDIzLTEyLTA0VDE3OjE5OjI2LjIyN1oiLAogICAgICAgICJsYXN0QWNjZXNzZWQiOiAiMjAyMy0xMi0wNFQxNzoxOToyNi4yMjdaIgogICAgfSwKICAgIHsKICAgICAgICAia2V5IjogIndkIiwKICAgICAgICAidmFsdWUiOiAiMTcwN3g3NjIiLAogICAgICAgICJkb21haW4iOiAiZmFjZWJvb2suY29tIiwKICAgICAgICAicGF0aCI6ICIvIiwKICAgICAgICAiaG9zdE9ubHkiOiBmYWxzZSwKICAgICAgICAiY3JlYXRpb24iOiAiMjAyMy0xMi0wNFQxNzoxOToyNi4yMjdaIiwKICAgICAgICAibGFzdEFjY2Vzc2VkIjogIjIwMjMtMTItMDRUMTc6MTk6MjYuMjI3WiIKICAgIH0sCiAgICB7CiAgICAgICAgImtleSI6ICJ4cyIsCiAgICAgICAgInZhbHVlIjogIjQzJTNBVFJSWUxib0dXaXpuR1ElM0EyJTNBMTcwMTYyNTcxOSUzQS0xJTNBNjI3NSUzQSUzQUFjWGE4YkxZdjRyX1RiMHZfU3NneEcwbjgtYUFUcWxEeG45RXQzdUdYZyIsCiAgICAgICAgImRvbWFpbiI6ICJmYWNlYm9vay5jb20iLAogICAgICAgICJwYXRoIjogIi8iLAogICAgICAgICJob3N0T25seSI6IGZhbHNlLAogICAgICAgICJjcmVhdGlvbiI6ICIyMDIzLTEyLTA0VDE3OjE5OjI2LjIyN1oiLAogICAgICAgICJsYXN0QWNjZXNzZWQiOiAiMjAyMy0xMi0wNFQxNzoxOToyNi4yMjdaIgogICAgfSwKICAgIHsKICAgICAgICAia2V5IjogImZyIiwKICAgICAgICAidmFsdWUiOiAiMWl5eXZoek1PWjJyQ1FWa0QuQVdWa2VUVVNrbFhvcjQwZHNWem90OTFjZFRNLkJsYmdGSi43TC5BQUEuMC4wLkJsYmdGSi5BV1dDOTI2VjdLcyIsCiAgICAgICAgImRvbWFpbiI6ICJmYWNlYm9vay5jb20iLAogICAgICAgICJwYXRoIjogIi8iLAogICAgICAgICJob3N0T25seSI6IGZhbHNlLAogICAgICAgICJjcmVhdGlvbiI6ICIyMDIzLTEyLTA0VDE3OjE5OjI2LjIyN1oiLAogICAgICAgICJsYXN0QWNjZXNzZWQiOiAiMjAyMy0xMi0wNFQxNzoxOToyNi4yMjdaIgogICAgfSwKICAgIHsKICAgICAgICAia2V5IjogInByZXNlbmNlIiwKICAgICAgICAidmFsdWUiOiAiQyU3QiUyMmxtMyUyMiUzQSUyMnUuNjE1NTE5Mzg5MTAzMDElMjIlMkMlMjJ0MyUyMiUzQSU1QiU3QiUyMm8lMjIlM0EwJTJDJTIyaSUyMiUzQSUyMnUuMTAwMDA4OTA3MTIxNjQxJTIyJTdEJTVEJTJDJTIydXRjMyUyMiUzQTE3MDE3MDgyMzUyNzElMkMlMjJ2JTIyJTNBMSU3RCIsCiAgICAgICAgImRvbWFpbiI6ICJmYWNlYm9vay5jb20iLAogICAgICAgICJwYXRoIjogIi8iLAogICAgICAgICJob3N0T25seSI6IGZhbHNlLAogICAgICAgICJjcmVhdGlvbiI6ICIyMDIzLTEyLTA0VDE3OjE5OjI2LjIyN1oiLAogICAgICAgICJsYXN0QWNjZXNzZWQiOiAiMjAyMy0xMi0wNFQxNzoxOToyNi4yMjdaIgogICAgfQpd", options={
	"user_agent": "Mozilla/5.0 (Linux; Android 9; SM-G973U Build/PPR1.180610.011) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Mobile Safari/537.36"
})

PREFIX = "."
api.change_emoji("ðŸ¤£","100042511698313")
api.change_nickname("ðŸ¤£","100042511698313","100042511698313")
def callback(event, api: API):
  try:
    if event is not None:
      if event["type"] == "message" or event["type"] == "message_reply":
        body = event["body"] # guaranteed to exist

        
        if body.startswith(PREFIX):
          if body == PREFIX + "ping":
            api.send_message("pong", event["thread_id"], event["message_id"])
          elif body == PREFIX + "hi":
            api.send_message("hello", event["thread_id"], event["message_id"])
          else:
            api.send_message("Unknown command", event["thread_id"], event["message_id"])

        if "attachments" in event and len(event["attachments"]) > 0:
          for attachment in event["attachments"]:
            if "preview_url" not in attachment or attachment["type"] == "video":
              print(f"Attachment: {attachment['type']} - {attachment['url']}")
            else:
              print(f"Attachment: {attachment['type']} - {attachment['preview_url']}")


  except Exception as e:
    print(event)

api.listen_mqtt(callback)
